缓存机制

缓存的实现机制
定义模型：
定义下面一个简单的存储模型
1.cpu和内存之间只加了一层高速缓存；
2.存储地址为4位，即内存中最多存16个字节；

缓存模型：
1.分组
根据地址的中间2位，把缓存分为了4组，每组对应地址如下：
第0组：	0 0 0 0
	0 0 0 1 
	1 0 0 0 
	1 0 0 1 

第1组：	0 0 1 0
	0 0 1 1 
	1 0 1 0 
	1 0 1 1

第2组：	0 1 0 0
	0 1 0 1 
	1 1 0 0 
	1 1 0 1

第3组：	0 1 1 0
	0 1 1 1 
	1 1 1 0 
	1 1 1 1

2.偏移量

地址的最后一位，定义了数据的偏移量，每个偏移量存储1个字节；1位的偏移量地址可存储2个字节，即0存储1个字节，1存储1个字节；由于没组只有1行，此时的缓存容量为 组数*偏移量个数，即4*2=8字节； 

3.标位位
地址的第一位是缓存的标识位，当组数1样时，通过标识位判断缓存中存储的块；

缓存过程

初始状态缓存是空的，当cpu通过地址（假设为0001）要加载一个数据时，此时cpu会先查找高速缓存，通过缓存的标识位判断缓存是空的，然后从内存中根据地址0001取得值，注意此时不会从内存中只取0001处的值，而是根据缓存的块的大小取得2个字节，即0000和0001两处的值。然后会把这两个值放在缓存中组为0（由地址中间2位决定），偏移量为0和1的地址处，最后才把地址加载入cpu。

接下来，cpu如果要取0000处的值，此时也会先查找缓存，通过中间2位00找到缓存的组数为0，第1个标识位0知道数据已存入缓存，此时会直接从偏移量0处得到值，不需要在查找内存；

如果接下来cpu要取1000处的值，此时会查找到组0，由于第1位标识位为1，和缓存中已存在的值的标识位不符合，说明缓存中不存在要取的值，cpu会从内存中取得值，并把缓存组0处的数据覆盖掉，此时会把组的标识位设置为1.

小结：cpu加载机制为，通过地址先查找缓存，查找过程为，先通过中间的组标识位，判断组，根据组的标识位判断当前组是否有数据，如果有，则直接从缓存中取数据，如果没有则从内存中取出1个块，并填充当前组。

内存中的空间和缓存中的空间是一种多对一的映射关系，比如本例中地址0和地址8所指的内存空间的内容，在缓存中
都存在第0组偏移量为0的空间中；他们的在缓存中的区分由地址的最高位决定。
