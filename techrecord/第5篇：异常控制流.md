一、什么是异常控制流
计算机指令存储在内存中，处理器通过程序计数器指向的地址不断的从内存中加载指令来执行。正常情况下，处理器执行的一系列指令在内存中的地址是连续的。但在下面两种情况下，加载的指令的地址会发生突变：
1. 执行的指令属于跳转语句：比如函数调用，for循环，switch语句等
2. 处理器状态发生变化
其中第二种情况引起的指令地址的突变称之为异常；如果把一系列指令称之为控制流的话，这种控制流发生突变的情况称之为异常控制流；

二、发生异常的原因
下面四中情况会引发异常

1. 中断
中断与当前执行的指令无关，它是由来自处理器外部的I/O设备发出的信号引起的，比如网络适配器、磁盘控制器、USB控制器（鼠标、键盘输入）和定时器芯片通过向处理器芯片上的一个引脚发信号，并将一个异常号放在系统总线上，来触发中断。

2. 陷阱
陷阱是有意的异常，是执行一条指令的结果。陷阱最重要的用途是在用户程序和内核中间提供一个像过程调用一样的接口，叫做系统调用。常见的系统调用有，读一个文件、创建一个新进程、加载一个新程序、终止当前进程等。
从程序员角度看，系统调用和函数调用是一样的，然而，它们的实现非常不同。普通的函数运行在用户模式中，用户模式限制了函数可以执行的指令的类型，而且它们只能访问与调用函数相同的栈。系统调用运行在内核模式中，内核模式允许系统调用执行特权指令，并访问定义在内核中的栈。

3. 故障
故障由错误程序引发，它可能被故障处理程序修正。

4. 终止
终止是不可恢复的致命错误造成的结果，通常是一些硬件错误。终止会导致当前进程直接退出。

三、异常处理
导致异常发生的处理器状态的变化称之为事件，每个事件都有一个异常号。在操作系统中为每一种异常事件都定义了对应的异常处理程序，当异常发生时，会跳转到对应的异常处理程序。这个过程是如何发生的呢？在系统启动时 ，操作系统会分配和初始化一张称为异常表的跳转表，使得表目k包含异常k的处理程序的地址，在程序运行时，当处理器检测到发生一个事件，并且确定了异常号k，这时就可以通过查询异常表跳转到相应的处理程序执行。 
图：异常表

当处理程序执行完成后，根据引起异常的事件的类型，会发生以下3种情况中的一种：
1. 处理程序将控制返回给当前指令，即事件发生时正在执行的指令，比如故障的异常处理程序。
2. 处理程序将控制返回给下一条指令，即没有发生异常时将会执行的下一条指令，比如中断、和陷阱的异常处理程序。
3. 处理程序终止被中断的程序，比如终止的异常处理程序。



