## [<<目录](https://github.com/snsart/blog/blob/master/README.md)

## redux总结：产生、特征、组成及应用
redux架构的产生是为了维护代码结构并解决组件之间通信的问题。适用于多交互、多数据源的情况。redux设计思想很简单，就两句话：
1. web应用是一个状态机，视图与状态是一一对应的。
2. 所有的状态，保存在一个对象里。

### redux中的核心概念
1. Store
Store就是保存数据的地方，可以把它看成一个容器。整个应用只能有一个 Store。Redux 提供createStore这个函数，用来生成 Store。
```
import { createStore } from 'redux';
const store = createStore(reducer);
```

2. State
Store对象包含的数据，当前时刻的State，可以通过store.getState()拿到

3. Action
action相当于事件机制中的事件，它必须有一个type属性，表示action的名称。另外还可以设置其他属性
```
const action = {
  type: 'ADD_TODO',
  payload: 'Learn Redux'
};
```
4. reducer
reducer是一个函数，它接受当前state和action作为参数，返回一个新的state。
const reducer=function(state,action){
	return new_state;
}

### redux通信过程
主要借助Store的以下三个函数进行组件间通信：
```
store.getState();
store.dispatch();
store.subscribe();
```
首先用户发出action
```
store.dispatch(action);
```
store自动调用reducer，并且传入两个参数，当前state和收到的action，reducer会返回新的state(在创建store时已经把rducer作为参数传给了store，所以store持有reducer函数)。<br>
state一旦有了变化，Store就会调用监听函数
```
store.subscribe(listener);
```
listener可以通过store.getState()得到当前状态。如果使用的是 React，这时可以触发重新渲染 View。<br>
一个应用中只有一个store和reducer，但是有多个action。

### 中间件
redux中间件，是为了增强redux的功能，实现方式是改造dispatch函数，增强其功能；比如：redux-thunk中间件可以使dispatch接受一个函数作为参数。
* 使用方式
需要引入applyMiddleware函数作为createStore的第二个参数（如果createStore方法接受整个应用的初始状态作为参数，那样的话，applyMiddleware就是第三个参数了。），然后把要使用的中间件作为参数传递给applyMiddleware函数
```
import { applyMiddleware, createStore } from 'redux';
import thunk from 'redux-thunk';
const store = createStore(
  reducer,
  applyMiddleware(thunk)
);
```
然后store.dispatch就可以接受函数作为参数了
```
store.dispatch((dispatch，getState)=>{
	\\...
})
```
传入的函数需要把dispatch和getState这两个 Redux方法作为形式参数，在函数内部可以使用这两个方法来发送action和获取state。