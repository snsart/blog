## [<<目录](https://github.com/snsart/blog/blob/master/README.md)

## 享元模式（Flyweight）
运用共享技术有效地支持大量细粒度对象的复用。系统只使用少量的对象，而这些对象都很相似，状态变化很小，可以实现对象的多次复用。由于享元模式要求能够共享的对象必须是细粒度对象，因此它又称为轻量级模式，它是一种对象结构型模式。享元模式主要用于减少创建对象的数量，以减少内存占用和提高性能。<br>
![享元模式](https://github.com/snsart/blog/blob/master/diary/images/2018122402.jpg);

### 主要解决：
在有大量对象时，有可能会造成内存溢出，我们把其中共同的部分抽象出来，如果有相同的业务请求，直接返回在内存中已有的对象，避免重新创建。享元模式的目的是为了提供程序的执行效率与系统的性能。比如游戏地图上的树、房屋等。

### 实现方式
1. 分析：分离要创建的对象的内部状态（共享的）和外部状态（特殊的）。内部状态是存储在享元对象内部并且不会随环境改变而改变的状态，内部状态可以共享。如字符的内容，不会随外部环境的变化而变化，无论在任何环境下字符“a”始终是“a”，都不会变成“b”。外部状态是随环境改变而改变的、不可以共享的状态,如字符的颜色、位置。享元对象的外部状态通常由客户端保存，并在享元对象被创建之后，需要使用的时候再传入到享元对象内部。
2. 为创建的享元类对象，添加唯一的标识符，每次创建对象时判断内存中是否存在此标识符标识的对象，若存在则返回此对象，否则创建新对象。
3. 享元工厂角色：往往需要借助工厂方法，创建享元对象。享元工厂中需要有一个对象池，当一个客户端对象调用一个享元对象的时候，享元工厂角色会检查对象池中是否已经有一个符合要求的享元对象。如果已经有了，享元工厂角色就应当提供这个已有的享元对象；如果对象池没有一个适当的享元对象的话，享元工厂角色就应当创建一个合适的享元对象，并把此对象加入对象池。

### 常见用途
1. 创建切换列表菜单，比如需切换的菜单共有100种，屏幕上每次只显示5种，这种时候我们不需要创建100个列表，只需要运用享元模式创建5个，每次切换时改变菜单内容即可。
2. 字符处理软件中，如果每个字符都用1个对象表示的话，将占用大量内存，由于文本中存在大量相同的字符，因此可以用享元模式。  java中的String类使用了享元模式。<br>
![享元字符](https://github.com/snsart/blog/blob/master/diary/images/2018122401.jpg);

### 享元模式与单例模式的比较
享元模式和单例本质都是共享对象，但享元模式共享的是池，而不是单一对象，并且需要一个工厂来管理这个池，当然这个池的大小可以是1个。单例模式的目的是只允许创建1个对象，并且不需要工厂方法管理。享元模式中工厂方法对象，可以使用单例模式进行创建，保证工厂类的唯一性。

## 桥接模式（Bridge）
桥接是用于把抽象化与实现化解耦，抽象类和实现类之间不是通过继承，而是通过桥接在抽象层建立关联关系（把对象当参数传递的形式关联在一起）。

### 主要解决
在有多种可能会变化的情况下，用继承会造成类爆炸问题，扩展起来不灵活。比如要设计各种类型（比如电脑、笔记本、智能手机、ipad等），各种品牌（比如联想、戴尔、华硕等）的计算机。这里品牌是计算机的一个实现，我们还可以动态的添加其他实现比如颜色等。即当实现系统可能有多个角度分类，每一种角度都可能变化的情况下用桥接。

### 解决方案
把多角度分类分离出来，让它们独立变化，减少它们之间耦合。比如上面情况，可以创建一个计算机类和一个品牌类。可以把品牌（比如联想）作为计算机（比如笔记本）的参数，创建某种品牌的计算机（联想笔记本）；

### 使用场景： 
1. 如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。 
2. 对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。
3. 一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。

* 注意事项：对于两个独立变化的维度，使用桥接模式再适合不过了。

### 具体应用举例
1. 为页面上不同的菜单添加不同的鼠标划入效果，可以抽象出一个方法，然后把菜单当做参数传入；
2. 创建不同粗细不同颜色的画笔；
![桥接举例：画笔](https://github.com/snsart/blog/blob/master/diary/images/2018122403.jpg);
